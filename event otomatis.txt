DELIMITER $$

ALTER DEFINER=`root`@`localhost` EVENT `event_bulanan` ON SCHEDULE EVERY 3 SECOND STARTS '2019-02-02 11:54:00' ON COMPLETION NOT PRESERVE ENABLE DO BEGIN 
	DECLARE id INT;
	DECLARE i INT;
	DECLARE total INT;
	DECLARE t INT;
	SET t=(SELECT COUNT(*) FROM tbl_tagihan WHERE MONTH(tanggal_event)=MONTH(NOW()) AND YEAR(tanggal_event)=YEAR(NOW()));
	IF t<1 THEN
	SET total=(SELECT id_anggota FROM tbl_anggota ORDER BY id_anggota DESC LIMIT 1);
	SET i=1;
	REPEAT
	SET id=(SELECT id_anggota FROM tbl_anggota WHERE id_anggota=i AND aktif='1');
	IF id!=0 THEN
	INSERT INTO tbl_tagihan(id_anggota) VALUES (id);
	END IF;
	SET i = i + 1;
	UNTIL i>total
        END REPEAT;
        END IF;
	END$$

DELIMITER ;